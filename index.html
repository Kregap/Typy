<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typy</title>
    <style>
    html, body {
      height: 100%;
      width: 100vw;
      margin: 0;
      padding: 0;
      font-family: 'MesloLGL Nerd Font', 'Segoe UI', sans-serif;
      background: #f8f8f8;
      color: #222;
      overflow-x: hidden;
    }
      #container {
        display: flex;
        height: 100vh;
        width: 100vw;
        justify-content: center;
        align-items: flex-start;
        overflow-x: hidden;
      }
      #workarea {
        width: 100vw;
        max-width: none;
        margin: 0;
  padding-left: 0;
      .preview-area {
        padding-left: 1em;
        display: table;
        margin-left: auto;
        margin-right: auto;
        width: auto;
        min-width: 40vw;
        max-width: 100vw;
  line-height: 1.02;
      }
        background: #fff;
        min-height: 100vh;
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
        gap: 0;
        overflow-x: hidden;
        word-break: break-word;
      }
      .edit-line {
        width: 100%;
        font-size: 1.1em;
        border: none;
        outline: none;
        background: #f8f8f8;
        color: #222;
        padding: 0 0.4em;
        margin: 0;
        box-sizing: border-box;
        line-height: 1.05;
        white-space: pre-wrap;
        overflow-x: hidden;
        word-break: break-word;
      }
      .preview-line {
        width: 100%;
        font-size: 0.95em;
        color: #222;
        padding: 0 !important;
        margin-left: 2em !important;
        margin: 0 !important;
        background: transparent;
        cursor: pointer;
        min-height: 0 !important;
        height: auto !important;
        box-sizing: border-box !important;
        line-height: 1 !important;
        white-space: pre-wrap !important;
        overflow-x: hidden !important;
        overflow-y: hidden !important;
        word-break: break-word !important;
        display: block !important;
      }
      .preview-line * {
        margin: 0 !important;
        padding: 0 !important;
        line-height: 1 !important;
        min-height: 0 !important;
        height: auto !important;
        box-sizing: border-box !important;
        border: none !important;
        background: transparent !important;
      }
      .preview-line img, .preview-area img {
        width: 100%;
        max-width: 100%;
        height: auto;
        display: block;
        margin-left: auto;
        margin-right: auto;
      }
      /* Restore natural markdown spacing for preview mode */
      .preview-line p,
      .preview-line h1,
      .preview-line h2,
      .preview-line h3,
      .preview-line h4,
      .preview-line h5,
      .preview-line h6,
      .preview-line ul,
      .preview-line ol,
      .preview-line li,
      .preview-line blockquote,
      .preview-line pre,
      .preview-line hr,
      .preview-line table,
      .preview-line tr,
      .preview-line td,
      .preview-line th {
        margin: 0 !important;
        padding: 0 !important;
        line-height: 1 !important;
        border: none !important;
        min-height: 0 !important;
        height: auto !important;
        box-sizing: border-box !important;
      }
      .preview-line blockquote {
        border-left: 2px solid #ccc;
        padding-left: 0.5em;
      }
      .preview-line pre {
        background: #f4f4f4;
        border-radius: 3px;
        font-size: 0.98em;
      }
  </style>
  </head>
  <body>
    <div id="container">
      <div id="workarea"></div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="editor.js"></script>
    <script>
    const workarea = document.getElementById('workarea');
    window.typoraLite.setWorkarea(workarea);
    window.typoraLite.render();
    window.typoraLite.focusInput();
    // Mouse and keyboard shortcuts
    let isRightDragging = false;
    let lastX = 0, lastY = 0;
    document.addEventListener('mousedown', (e) => {
      if (window.typoraLite.handleMousedown(e)) return;
      if (e.button === 2) {
        isRightDragging = true;
        lastX = e.screenX;
        lastY = e.screenY;
        e.preventDefault();
      }
    });
    document.addEventListener('mousemove', (e) => {
      if (isRightDragging) {
        const dx = e.screenX - lastX;
        const dy = e.screenY - lastY;
        if (window.electronAPI && (dx !== 0 || dy !== 0)) {
          window.electronAPI.moveWindow(dx, dy);
        }
        lastX = e.screenX;
        lastY = e.screenY;
      }
    });
    document.addEventListener('mouseup', (e) => {
      if (e.button === 2) {
        isRightDragging = false;
      }
    });
    document.addEventListener('contextmenu', (e) => {
      if (isRightDragging) e.preventDefault();
    });
    document.addEventListener('keydown', window.typoraLite.handleKeydown);
  </script>
  </body>
</html>
